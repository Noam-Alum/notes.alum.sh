<div dir="rtl">

# OSPF

**OSPF** הוא פרוטקול מסוג **link state** המשתמש באלגוריטם בשם **דיאקסטרה** והוא מכניס את המסלול עם ה **cost** המצתבר הנמוך ביותר לטבלת הניתוב.

### יש ל OSPF שלושה טבלאות:

1. **טבלת ניתוב:** מחזיקה את כל המסלולים של ה**metric** שלהם הכי נמוך.

2. **טבלת שכנים:** טבלה זו מחזיקה את הנתבים איתם קיימים יחסי שכנות.

3. **טבלת טופולוגיה:** טבלה זו מציגה את ה**Database** של הנתב.

### קיימות חמישה סוגי הודעות:

| **הודעה** | **תיאור**                                                                                                          |
| --------- | ------------------------------------------------------------------------------------------------------------------ |
| **Hello** | ליצור וליצר יחסי שכנות; האינטרבל של הודעה זו ברשתות **P2P** ו **MULI ACCESS** הוא 10, ברשתות **NBMA** הוא יהיה 30. |
| **DBD**   | תקציר של ה Database של הנתב.                                                                                       |
| **LSR**   | בקשה למידע מנתב אחר.                                                                                               |
| **LSU**   | תשובה לבקשת מידע.                                                                                                  |
| **LSA**   | פרסום מידע.                                                                                                        |

## איך עובד פרוטוקול מסוג link state?

1. כל נתב לומד על הקישורים שמחוברים אליו ישירות.

2. שולח הודעת **HELLO** לראות את המכשירים המחוברים אליו ישירות.

3. כל נתב מתחיל לבנות חבילה שנקראת **LSP** שבה מוחזק מידע על כל אחד מהממשקים שלו.
   
   - Neighbor ID
   
   - Line type
   
   - Bandwidth

4. כל נתב שולח את הודעת ה **LSP** לכל הממשקים שלו.

5. כל נתב בונה את ה **Database** שלו.

### שלבי יצירת יחסי שכנות ב OSPF

</div>

<Stepper>
    <StepperItem title="DOWN">
        Nothing much.
    </StepperItem>
    <StepperItem title="INIT">
        Hello packets are sent.
    </StepperItem>
    <StepperItem title="Two way">
        Hello packets being sent back.
    </StepperItem>
    <StepperItem title="Exstart">
        The DR and BDR are elected, and the primary-secondary relationship is established for sequence number assignment.
    </StepperItem>
    <StepperItem title="Exchange">
       OSPF routers exchange DBD packets containing LSA headers, compare databases, and send link-state request and update packets. 
    </StepperItem>
    <StepperItem title="Loading">
      Routers exchange link-state information via request and update packets, ensuring all LSAs are current. 
    </StepperItem>
    <StepperItem title="Full">
       Routers reach full adjacency, with synchronized LSAs and databases, indicating successful neighbor relationships. 
    </StepperItem>
</Stepper>

<div dir="rtl">

![](/Hoshen/routing/ospf/1.jpg)

---

## סוגי הודעות LSA

> כדי לבחור **DR** באופן יזום, נשנה את ה **Priority** של הממשק ב *OSPF*, אם נרצה שמתג לא יהיה בחיים **DR** או **BDR** ניתן לו **Priority 0**.
> 
> במידה וה **Priority** של הממשק אותו הדבר נבחר את ה **DR** ו **BDR** לפי ה **Router ID**.

### סוג 1 - Router Link-State Advertisement

| **מאפיין**  | **תיאור**                                                                                          |
| ----------- | -------------------------------------------------------------------------------------------------- |
| **מי יוצר** | כל נתב ב-OSPF                                                                                      |
| **תיאור**   | מכיל רשימה של כל הממשקים המחוברים של הנתב והמצב שלהם, כולל הרשתות המחוברות.                        |
| **מטרה**    | מפרסם את הממשקים והמצבים של הנתב עצמו. משמש לבניית מסד הנתונים של מצב הקישורים (LSDB/DBD) של הנתב. |
| **היקף**    | מקומי לנתב; משתף עם נתבים אחרים באותו אזור.                                                        |

### סוג 2 - Network Link-State Advertisement

| **מאפיין**  | **תיאור**                                             |
| ----------- | ----------------------------------------------------- |
| **מי יוצר** | נתב DR                                                |
| **תיאור**   | מתאר את הנתבים המחוברים לרשת.                         |
| **מטרה**    | מפרסם את קיומה של הרשת ומפרט את הנתבים המחוברים אליה. |
| **היקף**    | מקומי לאזור שבו נמצאת הרשת.                           |

### סוג 3 - Summary Link-State Advertisement

| **מאפיין**  | **תיאור**                                                                 |
| ----------- | ------------------------------------------------------------------------- |
| **מי יוצר** | נתב ABR                                                                   |
| **תיאור**   | מסכם מידע אודות רשתות באזורים אחרים של OSPF.                              |
| **מטרה**    | מפרסם רשתות השייכות לאזורים שונים, מצמצם את כמות המידע המועבר בין אזורים. |
| **היקף**    | בין אזורים שונים ב-OSPF.                                                  |

### סוג 4 - ASBR Summary Link-State Advertisement

| **מאפיין**  | **תיאור**                                                         |
| ----------- | ----------------------------------------------------------------- |
| **מי יוצר** | נתב ABR                                                           |
| **תיאור**   | מפרסם את קיום ה-ASBR ב-OSPF.                                      |
| **מטרה**    | מיידע נתבים אחרים באזור איך להגיע ל-ASBR, שמחובר לרשתות חיצוניות. |
| **היקף**    | מקומי לאזור; משמש לשדרוג נתבים לרשתות חיצוניות.                   |

### סוג 5 - External Link-State Advertisement

| **מאפיין**  | **תיאור**                                                               |
| ----------- | ----------------------------------------------------------------------- |
| **מי יוצר** | ASBR                                                                    |
| **תיאור**   | מפרסם נתיבי המועברים דרך ASBR, ולא חלק מ OSPF (לדוגמא EIGRP)            |
| **מטרה**    | מספק מידע על נתיבים חיצוניים, כמו ל RIP למשל, לכל הנתבים במערכת ה-OSPF. |
| **היקף**    | מתפשט לכל מערכת ה-OSPF (AS).                                            |

### סוג 6 - Group Membership Link-State Advertisement

| **מאפיין**  | **תיאור**                                                       |
| ----------- | --------------------------------------------------------------- |
| **מי יוצר** | משתמש ב-MOSPF (Multicast OSPF)                                  |
| **תיאור**   | מפרסם חברות בקבוצת מולטי-קסט.                                   |
| **מטרה**    | מספק מידע על קבוצות מולטי-קסט לנתבים כדי לתמוך בנתוב מולטי-קסט. |
| **היקף**    | מקומי לרשתות OSPF מולטי-קסט (MOSPF).                            |

### סוג 7 - Not-So-Stubby Area External LSA

| **מאפיין**  | **תיאור**                                                                            |
| ----------- | ------------------------------------------------------------------------------------ |
| **מי יוצר** | AS Boundary Router (ASBR) ב-NSSA                                                     |
| **תיאור**   | מפרסם נתיבים חיצוניים לאזור NSSA.                                                    |
| **מטרה**    | מאפשר נתיבים חיצוניים לאזור NSSA, אך אלה מומרות ל-Type 5 כאשר הן מגיעות לאזור הגבול. |
| **היקף**    | מקומי ל-NSSA; מומר ל-Type 5 באזור הגבול.                                             |

## סוגי אריות (Areas) ב OSPF

ל **OSPF** כמה סוגים מיוחדים של אריות, ושמם **stub areas**, באיזורים אלו סוגי ההודעות שניתן לשלוח שונים ויוצרים מצב בו הודעות שאין בהן צורך לא ישלחו כלל וכן שומרות על תעבורה נמוכה יותר של הודעות *SPF* ועל טבלאות ניתוב קטנות יותר.

### Stub area

כל ההודעות שנשלחו כתוצאה מהפצה מחדש של פרוטוקול ניתוב אחר לא יתקבלו.

- ההודעה שלא תשלח היא **LSA 5**.
- כמובן שלא יהיה שימוש בנתבי ASBR.

### NSSA

**NSSA** או בשמו המלא *Not so stubby area* הוא איזור בו יש צורך להשתמש באיזור **Stub** אך קיים **ASBR** באיזור.

מכיוון שלא ניתן להשתמש בהודעת **LSA 5** נשתמש בהודעת **LSA 7**.

### Totally stub

באיזור זה אנו נחסום הודעות **LSA 3** ו- **LSA 5**, לא ניתן להשתמש ב **ASBR** באיזור זה.

### Totally NSSA

כמו מקודם, במקרה יש לנו **ASBR** באיזור אך הוא **Totally stub**, ישלחו הודעות **LSA 7**

</div>